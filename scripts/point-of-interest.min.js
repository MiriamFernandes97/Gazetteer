class PointOfInterest{constructor(t,i,e,s,a,n){this.latitude=t,this.longitude=i,this.geonameId=e,this.name=s,this.population=a,this.type=n}deg2rad(t){return t*(Math.PI/180)}getDistanceFromLatLonInKm(t,i){const e=this.deg2rad(this.latitude-t),s=this.deg2rad(this.longitude-i),a=Math.sin(e/2)*Math.sin(e/2)+Math.cos(this.deg2rad(t))*Math.cos(this.deg2rad(this.latitude))*Math.sin(s/2)*Math.sin(s/2),n=6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)));this.distance=n.toFixed()}getWikiDetails(){$.ajax({url:"php/getWikiUrl.php",dataType:"json",type:"POST",data:{geonameId:this.geonameId}}).then(t=>{const i=t.data;this.timeZone=i.timezone.timeZoneId,this.wikiUrl=i.wikipediaURL;const e=this.wikiUrl.split("/")[2];this.displayInfo(),$.ajax({url:"php/getWikiSummary.php",dataType:"json",type:"POST",data:{title:e}}).done(t=>{const i=Object.values(t.data)[0].extract;this.cleanExtract=i.replace(/\(listen\)/,""),this.displayWikiDetails()}).fail(()=>{this.displayInfo(),this.wikiFailure()})}).fail(()=>{this.displayInfo(),this.wikiFailure()})}displayWikiDetails(){$("#modalBody").html(`${this.cleanExtract}<br><a href=https://${this.wikiUrl} target="_blank">Full Wikipedia Article</a>`)}getTime(){const t=new Date;this.time=t.toLocaleString("en-GB",{timeZone:this.timeZone,timeStyle:"short"})}wikiFailure(){$("#modalBody").html(`No wikipedia article could be found for this ${this.type}.`)}getWeatherInfo(){$.ajax({url:"php/getWeatherForecast.php",type:"POST",dataType:"json",data:{latitude:this.latitude,longitude:this.longitude}}).done(t=>{const i=t.data;this.currentWeather=i.current.weather[0],this.currentTemp=i.current.temp,this.humidity=i.current.humidity,this.pressure=i.current.pressure,this.dailyWeather=i.daily,this.displayWeather()})}displayWeather(){let t=0;this.dailyWeather.forEach(i=>{const e=new Date(1e3*i.dt).toLocaleString("en-GB",{timeZone:this.timeZone,weekday:"long"});$(`#forecastImg${t}`).attr("src",`https://openweathermap.org/img/wn/${i.weather[0].icon}@2x.png`),$(`#forecast${t}`).html(`<li>${e}</li><li>${i.weather[0].description}</li><li>Min Temp:&nbsp;${i.temp.min.toFixed()}&#8451;</li><li>Max Temp:&nbsp;${i.temp.max.toFixed()}&#8451;</li>`),t++}),$("#weatherImage").attr("src",`https://openweathermap.org/img/wn/${this.currentWeather.icon}@2x.png`),$("#weatherModalList").html(`<li>${this.currentWeather.description}</li><li>Temperature:&nbsp; ${this.currentTemp.toFixed()}&#8451;</li><li>Humidity:&nbsp;${this.humidity}%</li><li>Pressure:&nbsp${this.pressure}mb</li>`)}}class Monument extends PointOfInterest{constructor(t,i,e,s){super(t,i,e,s),this.type="monument"}displayInfo(){this.getTime(),$("#modalTitle").html(`${this.name}`),$("#modalInfo").html(`<li>Current Time: &nbsp; ${this.time}</li><li>Latitude: &nbsp; ${this.latitude}</li><li>Longitude: &nbsp; ${this.longitude}</li><li>Distance from your location: &nbsp; ${this.distance}km</li>`),$("#wikiInfo").removeClass("show"),$("#forecastInfo").removeClass("show"),$("#weatherInfo").removeClass("show"),$("#generalInfo").addClass("show"),$("#infoModal").modal()}}class City extends PointOfInterest{constructor(t,i,e,s,a,n){super(t,i,e,s,a,n)}displayInfo(){this.getTime(),$("#modalTitle").html(`${this.name}`),$("#modalInfo").html(`<li>Current Time: &nbsp; ${this.time}</li><li>Estimated Population: &nbsp; ${this.population}</li>\n      <li>Latitude: &nbsp; ${this.latitude}</li><li>Longitude: &nbsp; ${this.longitude}</li><li>Distance from your location: &nbsp; ${this.distance}km</li>`),$("#wikiInfo").removeClass("show"),$("#forecastInfo").removeClass("show"),$("#weatherInfo").removeClass("show"),$("#generalInfo").addClass("show"),$("#infoModal").modal()}}